
---
uid: SC-20180701-PhD
abbr: PhD
alias:
- SC-20180701-PhD
funding: 
location: åŒ—äº¬å¸ˆèŒƒå¤§å­¦
principal: å®‹çˆ½
participants:
start: 2018-07-01
end: 2023-06-30
status: å·²å®Œæˆ
founding_no: 
tags:
- project/experience
- project/archive
target: tasks
---


# é¡¹ç›®è¿›åº¦æ¦‚è§ˆ

## ä¸»çº¿ä»»åŠ¡
- [x] åšå£«æ¯•ä¸š ğŸ“… 2023-06-30
- [x] æ‰¾åˆ°å·¥ä½œ ğŸ“… 2023-05-30
## æ”¯çº¿ä»»åŠ¡
- [x] å‘è¡¨å­¦æœ¯è®ºæ–‡

## è¿›å±•è®°å½•
```dataviewjs
// 1. å®šä¹‰æ–‡ä»¶å¤¹è·¯å¾„å’Œå¼€å§‹ç»“æŸå­—ç¬¦ä¸²
let diaryFolderPath = "00 - æ¯æ—¥æ—¥è®°";
let names = dv.current().alias ? dv.current().alias : [];
names.push(dv.current().name)
let token = dv.current().uid

// å®šä¹‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…ä»¥ '**xxx**' æˆ– '# XX' å¼€å¤´çš„è¡Œ
let endPattern = /^(#+ .+|\*\*.+\*\*)/; 

// 2. è·å–åŒ…å« diaryFolderPath çš„æ‰€æœ‰ markdown æ–‡ä»¶
const diaryFiles = app.vault.getMarkdownFiles().filter(file => file.path.includes(diaryFolderPath));

// 3. éå†æ‰€æœ‰æ—¥è®°æ–‡ä»¶ï¼Œå¯¹æ¯ä¸ªæ–‡ä»¶å†…å®¹è¿›è¡Œå¤„ç†
let diaryContentPromises = diaryFiles.map(file => {
  // ä½¿ç”¨å¼‚æ­¥æ“ä½œè¯»å–æ–‡ä»¶å†…å®¹
  return app.vault.cachedRead(file).then(content => {
    // åˆ†å‰²å†…å®¹ä¸ºå•ç‹¬çš„è¡Œ
    let lines = content.split("\n");
    let summary = "";
    let capture = false;

    // 4. éå†æ‰€æœ‰è¡Œ
    lines.forEach(line => {
      if (line.includes(token)) {
        // å¦‚æœè¡Œä»¥ startStr å¼€å¤´ï¼Œåˆ™å¼€å§‹æ•è·
        capture = true;
      } else if (endPattern.test(line)) { 
        // å¦‚æœè¡Œæ»¡è¶³ endPatternï¼Œé‚£ä¹ˆç»“æŸæ•è·
        capture = false;
      } else if (capture && !line.includes(token)) { 
        // å¦‚æœå¤„äºæ•è·çŠ¶æ€ä¸”è¡Œä¸ä»¥ startStr å¼€å¤´ï¼Œåˆ™å°†è¡Œæ·»åŠ åˆ° summary
        summary += line + "\n";
      }
    });

    // 5. æ¸…é™¤ summary çš„å‰åç©ºç™½
    summary = summary.trim();
    let date = file.basename;

    // 6. ä½¿ç”¨ moment.js æ ¼å¼åŒ–æ—¥æœŸï¼Œå°† 'YYYYå¹´MMæœˆDDæ—¥' è½¬æ¢ä¸º 'MæœˆDæ—¥'
    date = moment(date, 'YYYYå¹´MMæœˆDDæ—¥').format('MæœˆDæ—¥');

    // 7. å¦‚æœæ‰¾åˆ°äº†æ€»ç»“ï¼Œè¿”å›æ—¥æœŸå’Œæ€»ç»“
    if (summary) {
      return [date, summary];
    }
  });
});

// 8. ç­‰å¾…æ‰€æœ‰æ–‡ä»¶å†…å®¹å¤„ç†å®Œæˆ
Promise.all(diaryContentPromises).then(diaryContents => {
  // è¿‡æ»¤å‡ºå®šä¹‰äº†æ€»ç»“çš„æ–‡ä»¶å†…å®¹
  const validContents = diaryContents.filter(content => content !== undefined);
  // åœ¨ Dataview è¡¨æ ¼ä¸­æ˜¾ç¤ºç»“æœ
  dv.table(["æ—¥æœŸ", "è¿›å±•"], validContents);
});

```
# é¡¹ç›®èµ„äº§
- [åšå£«è®ºæ–‡ä»“åº“](https://github.com/SongshGeo/HumWat_YR_PhDThesis)
